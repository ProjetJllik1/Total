<!-- Ajouter après le premier élément li "Tableau de bord" -->
<li class="nav-item" data-section="AnalInvenIa-dashboard">
    <a href="#"><i class="fas fa-robot"></i> Analyse IA</a>
</li>


<!-- Section Analyse IA -->
<div id="AnalInvenIa-dashboard" class="content-section" style="display: none;">
    <h2 class="mb-4"><i class="fas fa-robot me-2"></i> Analyse IA de l'inventaire</h2>
    
    <div class="AnalInvenIa-intro-card">
        <div class="AnalInvenIa-intro-icon">
            <i class="fas fa-brain"></i>
        </div>
        <div class="AnalInvenIa-intro-content">
            <h3>Assistant d'analyse intelligent</h3>
            <p>Notre IA analyse en profondeur votre inventaire pour vous fournir des insights précis, des prévisions fiables et des recommandations personnalisées pour optimiser votre gestion de stock et maximiser vos profits.</p>
        </div>
    </div>
    
    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="fas fa-filter me-2"></i> Paramètres d'analyse</span>
            <div class="AnalInvenIa-header-actions">
                <button class="btn btn-sm btn-outline-secondary" id="AnalInvenIa-resetParams">
                    <i class="fas fa-undo-alt me-1"></i> Réinitialiser
                </button>
                <button class="btn btn-sm btn-primary" id="AnalInvenIa-runAnalysis">
                    <i class="fas fa-play me-1"></i> Lancer l'analyse
                </button>
            </div>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-4">
                        <label class="form-label fw-bold"><i class="fas fa-calendar-alt me-2"></i>Période d'analyse</label>
                        <div class="AnalInvenIa-tabs">
                            <div class="AnalInvenIa-tab active" data-filter="1">
                                <i class="fas fa-clock"></i> Intervalles
                            </div>
                            <div class="AnalInvenIa-tab" data-filter="2">
                                <i class="fas fa-history"></i> Relatif
                            </div>
                            <div class="AnalInvenIa-tab" data-filter="3">
                                <i class="fas fa-calendar-day"></i> Personnalisé
                            </div>
                        </div>
                        
                        <!-- Filtre 1: Intervalles -->
                        <div class="AnalInvenIa-filter-content active" id="AnalInvenIa-filter1">
                            <div class="AnalInvenIa-select-container">
                                <div class="AnalInvenIa-select" id="AnalInvenIa-intervalSelect">
                                    <div class="AnalInvenIa-select-value">
                                        <i class="fas fa-calendar-day me-2"></i>Journalier (par jours)
                                    </div>
                                    <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                    <div class="AnalInvenIa-select-dropdown">
                                        <div class="AnalInvenIa-select-option" data-value="hour">
                                            <i class="fas fa-hourglass me-2"></i>Par heure, minutes, secondes
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="day">
                                            <i class="fas fa-calendar-day me-2"></i>Journalier (par jours)
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="week">
                                            <i class="fas fa-calendar-week me-2"></i>Semestriel (par semaine)
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="month">
                                            <i class="fas fa-calendar-alt me-2"></i>Mensuel (par mois)
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="year">
                                            <i class="fas fa-calendar me-2"></i>Annuel (par année)
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Filtre 2: Période relative -->
                        <div class="AnalInvenIa-filter-content" id="AnalInvenIa-filter2">
                            <div class="AnalInvenIa-select-container">
                                <div class="AnalInvenIa-select" id="AnalInvenIa-relativeSelect">
                                    <div class="AnalInvenIa-select-value">
                                        <i class="fas fa-calendar-day me-2"></i>Aujourd'hui
                                    </div>
                                    <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                    <div class="AnalInvenIa-select-dropdown">
                                        <div class="AnalInvenIa-select-option" data-value="now">
                                            <i class="fas fa-bolt me-2"></i>À l'instant
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="today">
                                            <i class="fas fa-calendar-day me-2"></i>Aujourd'hui
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="yesterday">
                                            <i class="fas fa-calendar-day me-2"></i>Hier
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="thisWeek">
                                            <i class="fas fa-calendar-week me-2"></i>Cette semaine
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="lastWeek">
                                            <i class="fas fa-calendar-week me-2"></i>La semaine dernière
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="thisMonth">
                                            <i class="fas fa-calendar-alt me-2"></i>Ce mois-ci
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="lastMonth">
                                            <i class="fas fa-calendar-alt me-2"></i>Le mois dernier
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="thisYear">
                                            <i class="fas fa-calendar me-2"></i>Cette année
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="lastYear">
                                            <i class="fas fa-calendar me-2"></i>L'année dernière
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Filtre 3: Date personnalisée -->
                        <div class="AnalInvenIa-filter-content" id="AnalInvenIa-filter3">
                            <div class="AnalInvenIa-tabs AnalInvenIa-tabs-small">
                                <div class="AnalInvenIa-tab active" data-customfilter="range">
                                    <i class="fas fa-calendar-alt"></i> Plage
                                </div>
                                <div class="AnalInvenIa-tab" data-customfilter="year">
                                    <i class="fas fa-calendar"></i> Année
                                </div>
                                <div class="AnalInvenIa-tab" data-customfilter="month">
                                    <i class="fas fa-calendar-alt"></i> Mois
                                </div>
                                <div class="AnalInvenIa-tab" data-customfilter="day">
                                    <i class="fas fa-calendar-day"></i> Jour
                                </div>
                            </div>
                            
                            <div class="AnalInvenIa-custom-filter active" id="AnalInvenIa-customRange">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="AnalInvenIa-form-group">
                                            <label><i class="fas fa-calendar-alt me-1"></i> De</label>
                                            <input type="date" class="form-control" id="AnalInvenIa-startDate">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="AnalInvenIa-form-group">
                                            <label><i class="fas fa-calendar-alt me-1"></i> À</label>
                                            <input type="date" class="form-control" id="AnalInvenIa-endDate">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="AnalInvenIa-custom-filter" id="AnalInvenIa-customYear">
                                <div class="AnalInvenIa-select-container">
                                    <div class="AnalInvenIa-select" id="AnalInvenIa-yearSelect">
                                        <div class="AnalInvenIa-select-value">
                                            <i class="fas fa-calendar me-2"></i>2025
                                        </div>
                                        <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                        <div class="AnalInvenIa-select-dropdown">
                                            <div class="AnalInvenIa-select-option" data-value="2025">
                                                <i class="fas fa-calendar me-2"></i>2025
                                            </div>
                                            <div class="AnalInvenIa-select-option" data-value="2024">
                                                <i class="fas fa-calendar me-2"></i>2024
                                            </div>
                                            <div class="AnalInvenIa-select-option" data-value="2023">
                                                <i class="fas fa-calendar me-2"></i>2023
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="AnalInvenIa-custom-filter" id="AnalInvenIa-customMonth">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="AnalInvenIa-select-container">
                                            <div class="AnalInvenIa-select" id="AnalInvenIa-monthSelect">
                                                <div class="AnalInvenIa-select-value">
                                                    <i class="fas fa-calendar-alt me-2"></i>Mai
                                                </div>
                                                <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                                <div class="AnalInvenIa-select-dropdown">
                                                    <div class="AnalInvenIa-select-option" data-value="0">Janvier</div>
                                                    <div class="AnalInvenIa-select-option" data-value="1">Février</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2">Mars</div>
                                                    <div class="AnalInvenIa-select-option" data-value="3">Avril</div>
                                                    <div class="AnalInvenIa-select-option" data-value="4">Mai</div>
                                                    <div class="AnalInvenIa-select-option" data-value="5">Juin</div>
                                                    <div class="AnalInvenIa-select-option" data-value="6">Juillet</div>
                                                    <div class="AnalInvenIa-select-option" data-value="7">Août</div>
                                                    <div class="AnalInvenIa-select-option" data-value="8">Septembre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="9">Octobre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="10">Novembre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="11">Décembre</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="AnalInvenIa-select-container">
                                            <div class="AnalInvenIa-select" id="AnalInvenIa-yearForMonthSelect">
                                                <div class="AnalInvenIa-select-value">
                                                    <i class="fas fa-calendar me-2"></i>2025
                                                </div>
                                                <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                                <div class="AnalInvenIa-select-dropdown">
                                                    <div class="AnalInvenIa-select-option" data-value="2025">2025</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2024">2024</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2023">2023</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="AnalInvenIa-custom-filter" id="AnalInvenIa-customDay">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="AnalInvenIa-form-group">
                                            <label><i class="fas fa-calendar-day me-1"></i> Jour</label>
                                            <input type="number" class="form-control" id="AnalInvenIa-day" min="1" max="31" value="17">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="AnalInvenIa-select-container">
                                            <label><i class="fas fa-calendar-alt me-1"></i> Mois</label>
                                            <div class="AnalInvenIa-select" id="AnalInvenIa-monthForDaySelect">
                                                <div class="AnalInvenIa-select-value">Mai</div>
                                                <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                                <div class="AnalInvenIa-select-dropdown">
                                                    <div class="AnalInvenIa-select-option" data-value="0">Janvier</div>
                                                    <div class="AnalInvenIa-select-option" data-value="1">Février</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2">Mars</div>
                                                    <div class="AnalInvenIa-select-option" data-value="3">Avril</div>
                                                    <div class="AnalInvenIa-select-option" data-value="4">Mai</div>
                                                    <div class="AnalInvenIa-select-option" data-value="5">Juin</div>
                                                    <div class="AnalInvenIa-select-option" data-value="6">Juillet</div>
                                                    <div class="AnalInvenIa-select-option" data-value="7">Août</div>
                                                    <div class="AnalInvenIa-select-option" data-value="8">Septembre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="9">Octobre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="10">Novembre</div>
                                                    <div class="AnalInvenIa-select-option" data-value="11">Décembre</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="AnalInvenIa-select-container">
                                            <label><i class="fas fa-calendar me-1"></i> Année</label>
                                            <div class="AnalInvenIa-select" id="AnalInvenIa-yearForDaySelect">
                                                <div class="AnalInvenIa-select-value">2025</div>
                                                <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                                <div class="AnalInvenIa-select-dropdown">
                                                    <div class="AnalInvenIa-select-option" data-value="2025">2025</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2024">2024</div>
                                                    <div class="AnalInvenIa-select-option" data-value="2023">2023</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-4">
                        <label class="form-label fw-bold"><i class="fas fa-search me-2"></i>Portée d'analyse</label>
                        <div class="AnalInvenIa-scope-selector">
                            <div class="AnalInvenIa-scope-option active" data-scope="global">
                                <div class="AnalInvenIa-scope-icon">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="AnalInvenIa-scope-label">Global</div>
                                <div class="AnalInvenIa-scope-desc">Tous les produits</div>
                            </div>
                            <div class="AnalInvenIa-scope-option" data-scope="category">
                                <div class="AnalInvenIa-scope-icon">
                                    <i class="fas fa-folder"></i>
                                </div>
                                <div class="AnalInvenIa-scope-label">Catégorie</div>
                                <div class="AnalInvenIa-scope-desc">Une catégorie spécifique</div>
                            </div>
                            <div class="AnalInvenIa-scope-option" data-scope="product">
                                <div class="AnalInvenIa-scope-icon">
                                    <i class="fas fa-box"></i>
                                </div>
                                <div class="AnalInvenIa-scope-label">Produit</div>
                                <div class="AnalInvenIa-scope-desc">Un produit spécifique</div>
                            </div>
                        </div>
                        
                        <div id="AnalInvenIa-categorySelector" class="mt-3" style="display: none;">
                            <div class="AnalInvenIa-select-container">
                                <div class="AnalInvenIa-select" id="AnalInvenIa-categorySelect">
                                    <div class="AnalInvenIa-select-value">
                                        <i class="fas fa-folder me-2"></i>Sélectionner une catégorie
                                    </div>
                                    <i class="fas fa-chevron-down AnalInvenIa-select-arrow"></i>
                                    <div class="AnalInvenIa-select-dropdown">
                                        <div class="AnalInvenIa-select-option" data-value="electronics">
                                            <i class="fas fa-tv me-2"></i>Électronique
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="furniture">
                                            <i class="fas fa-couch me-2"></i>Mobilier
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="clothing">
                                            <i class="fas fa-tshirt me-2"></i>Vêtements
                                        </div>
                                        <div class="AnalInvenIa-select-option" data-value="food">
                                            <i class="fas fa-utensils me-2"></i>Alimentaire
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="AnalInvenIa-productSelector" class="mt-3" style="display: none;">
                            <div class="AnalInvenIa-search-container">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" class="form-control" id="AnalInvenIa-productSearch" placeholder="Rechercher un produit...">
                                </div>
                                <div id="AnalInvenIa-productResults" class="AnalInvenIa-search-results">
                                    <!-- Les résultats seront ajoutés dynamiquement -->
                                </div>
                            </div>
                            <div class="AnalInvenIa-selected-product mt-2" style="display: none;">
                                <div class="AnalInvenIa-product-badge">
                                    <i class="fas fa-box me-2"></i>
                                    <span id="AnalInvenIa-selectedProductName">Nom du produit</span>
                                    <button class="AnalInvenIa-remove-product">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="AnalInvenIa-analysis-footer">
                <div class="AnalInvenIa-analysis-status">
                    <i class="fas fa-circle-info me-2"></i>
                    Configurez les paramètres et lancez l'analyse pour obtenir des insights intelligents sur votre inventaire.
                </div>
                <div class="AnalInvenIa-analysis-actions">
                    <button class="btn btn-primary" id="AnalInvenIa-runBtn">
                        <i class="fas fa-robot me-2"></i> Lancer l'analyse IA
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Résultats d'analyse -->
    <div id="AnalInvenIa-results" style="display: none;">
        <div class="AnalInvenIa-results-header">
            <div class="AnalInvenIa-results-title">
                <i class="fas fa-chart-line me-2"></i>
                <span id="AnalInvenIa-analysisTitle">Analyse globale de l'inventaire</span>
                <span class="AnalInvenIa-period-badge" id="AnalInvenIa-analysisPeriod">Mai 2025</span>
            </div>
            <div class="AnalInvenIa-results-actions">
                <button class="btn btn-sm btn-outline-secondary" id="AnalInvenIa-printResults">
                    <i class="fas fa-print me-1"></i> Imprimer
                </button>
                <button class="btn btn-sm btn-outline-secondary" id="AnalInvenIa-exportResults">
                    <i class="fas fa-file-pdf me-1"></i> Exporter PDF
                </button>
                <button class="btn btn-sm btn-outline-primary" id="AnalInvenIa-newAnalysis">
                    <i class="fas fa-sliders-h me-1"></i> Nouvelle analyse
                </button>
            </div>
        </div>
        
        <div class="AnalInvenIa-insights-nav">
            <div class="AnalInvenIa-insight-tab active" data-tab="overview">
                <i class="fas fa-eye"></i>
                <span>Aperçu</span>
            </div>
            <div class="AnalInvenIa-insight-tab" data-tab="stats">
                <i class="fas fa-chart-pie"></i>
                <span>Statistiques</span>
            </div>
            <div class="AnalInvenIa-insight-tab" data-tab="products">
                <i class="fas fa-box-open"></i>
                <span>Produits</span>
            </div>
            <div class="AnalInvenIa-insight-tab" data-tab="predictions">
                <i class="fas fa-crystal-ball"></i>
                <span>Prévisions</span>
            </div>
            <div class="AnalInvenIa-insight-tab" data-tab="recommendations">
                <i class="fas fa-lightbulb"></i>
                <span>Recommandations</span>
            </div>
            <div class="AnalInvenIa-insight-tab" data-tab="reports">
                <i class="fas fa-file-alt"></i>
                <span>Rapports</span>
            </div>
        </div>
        
        <!-- Tab: Aperçu -->
        <div class="AnalInvenIa-insight-content active" id="AnalInvenIa-tab-overview">
            <div class="row">
                <div class="col-md-4">
                    <div class="AnalInvenIa-kpi-card">
                        <div class="AnalInvenIa-kpi-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="AnalInvenIa-kpi-content">
                            <div class="AnalInvenIa-kpi-value"><span id="AnalInvenIa-totalValue">24 850</span> €</div>
                            <div class="AnalInvenIa-kpi-label">Valeur totale du stock</div>
                            <div class="AnalInvenIa-kpi-trend positive">
                                <i class="fas fa-arrow-up me-1"></i> +8,5% par rapport au mois dernier
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="AnalInvenIa-kpi-card">
                        <div class="AnalInvenIa-kpi-icon">
                            <i class="fas fa-hand-holding-usd"></i>
                        </div>
                        <div class="AnalInvenIa-kpi-content">
                            <div class="AnalInvenIa-kpi-value"><span id="AnalInvenIa-salesValue">12 450</span> €</div>
                            <div class="AnalInvenIa-kpi-label">Ventes réalisées</div>
                            <div class="AnalInvenIa-kpi-trend positive">
                                <i class="fas fa-arrow-up me-1"></i> +12,3% par rapport au mois dernier
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="AnalInvenIa-kpi-card">
                        <div class="AnalInvenIa-kpi-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="AnalInvenIa-kpi-content">
                            <div class="AnalInvenIa-kpi-value"><span id="AnalInvenIa-stockIssues">5</span></div>
                            <div class="AnalInvenIa-kpi-label">Problèmes détectés</div>
                            <div class="AnalInvenIa-kpi-trend neutral">
                                <i class="fas fa-equals me-1"></i> Identique au mois dernier
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="fas fa-chart-line me-2"></i> Évolution des ventes</span>
                            <div class="AnalInvenIa-chart-controls">
                                <button class="AnalInvenIa-chart-control active" data-period="week">7J</button>
                                <button class="AnalInvenIa-chart-control" data-period="month">30J</button>
                                <button class="AnalInvenIa-chart-control" data-period="year">1A</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-chart-container">
                                <canvas id="AnalInvenIa-salesChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-lightbulb me-2"></i> Recommandations principales
                        </div>
                        <div class="card-body p-0">
                            <div class="AnalInvenIa-recommendation-list">
                                <div class="AnalInvenIa-recommendation-item">
                                    <div class="AnalInvenIa-recommendation-icon">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                    <div class="AnalInvenIa-recommendation-content">
                                        <div class="AnalInvenIa-recommendation-title">Augmenter le stock de Smartphone XL+</div>
                                        <div class="AnalInvenIa-recommendation-description">
                                            Les ventes augmentent de 15% chaque mois depuis 3 mois.
                                        </div>
                                    </div>
                                </div>
                                <div class="AnalInvenIa-recommendation-item">
                                    <div class="AnalInvenIa-recommendation-icon">
                                        <i class="fas fa-percentage"></i>
                                    </div>
                                    <div class="AnalInvenIa-recommendation-content">
                                        <div class="AnalInvenIa-recommendation-title">Augmenter le prix des Écouteurs sans fil Pro</div>
                                        <div class="AnalInvenIa-recommendation-description">
                                            Forte demande avec une élasticité-prix favorable. Potentiel +15% sans impact sur les ventes.
                                        </div>
                                    </div>
                                </div>
                                <div class="AnalInvenIa-recommendation-item">
                                    <div class="AnalInvenIa-recommendation-icon">
                                        <i class="fas fa-arrow-down"></i>
                                    </div>
                                    <div class="AnalInvenIa-recommendation-content">
                                        <div class="AnalInvenIa-recommendation-title">Réduire le stock de Casques gaming standard</div>
                                        <div class="AnalInvenIa-recommendation-description">
                                            Rotation lente, 35 unités en stock depuis plus de 60 jours.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-end">
                            <button class="btn btn-sm btn-outline-primary" id="AnalInvenIa-viewAllRecommendations">
                                Voir toutes les recommandations <i class="fas fa-arrow-right ms-1"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-trophy me-2"></i> Top produits
                        </div>
                        <div class="card-body p-0">
                            <div class="AnalInvenIa-tab-container">
                                <div class="AnalInvenIa-tabs AnalInvenIa-tabs-small">
                                    <div class="AnalInvenIa-tab active" data-toptab="bestsellers">
                                        <i class="fas fa-chart-line"></i> Meilleures ventes
                                    </div>
                                    <div class="AnalInvenIa-tab" data-toptab="profitable">
                                        <i class="fas fa-hand-holding-usd"></i> Plus rentables
                                    </div>
                                    <div class="AnalInvenIa-tab" data-toptab="critical">
                                        <i class="fas fa-exclamation-triangle"></i> État critique
                                    </div>
                                </div>
                                <div class="AnalInvenIa-top-products active" id="AnalInvenIa-bestsellers">
                                    <div class="AnalInvenIa-product-ranking">
                                        <div class="AnalInvenIa-product-rank">1</div>
                                        <div class="AnalInvenIa-product-info">
                                            <div class="AnalInvenIa-product-name">Smartphone XL+</div>
                                            <div class="AnalInvenIa-product-stats">
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-box me-1"></i> Stock: 32
                                                </span>
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-shopping-cart me-1"></i> Vendus: 78
                                                </span>
                                            </div>
                                        </div>
                                        <div class="AnalInvenIa-product-trend positive">
                                            <i class="fas fa-arrow-up"></i> 15%
                                        </div>
                                    </div>
                                    <div class="AnalInvenIa-product-ranking">
                                        <div class="AnalInvenIa-product-rank">2</div>
                                        <div class="AnalInvenIa-product-info">
                                            <div class="AnalInvenIa-product-name">Écouteurs sans fil Pro</div>
                                            <div class="AnalInvenIa-product-stats">
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-box me-1"></i> Stock: 45
                                                </span>
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-shopping-cart me-1"></i> Vendus: 64
                                                </span>
                                            </div>
                                        </div>
                                        <div class="AnalInvenIa-product-trend positive">
                                            <i class="fas fa-arrow-up"></i> 12%
                                        </div>
                                    </div>
                                    <div class="AnalInvenIa-product-ranking">
                                        <div class="AnalInvenIa-product-rank">3</div>
                                        <div class="AnalInvenIa-product-info">
                                            <div class="AnalInvenIa-product-name">Montre connectée Sport</div>
                                            <div class="AnalInvenIa-product-stats">
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-box me-1"></i> Stock: 28
                                                </span>
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-shopping-cart me-1"></i> Vendus: 52
                                                </span>
                                            </div>
                                        </div>
                                        <div class="AnalInvenIa-product-trend positive">
                                            <i class="fas fa-arrow-up"></i> 8%
                                        </div>
                                    </div>
                                    <div class="AnalInvenIa-product-ranking">
                                        <div class="AnalInvenIa-product-rank">4</div>
                                        <div class="AnalInvenIa-product-info">
                                            <div class="AnalInvenIa-product-name">Enceinte portable waterproof</div>
                                            <div class="AnalInvenIa-product-stats">
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-box me-1"></i> Stock: 40
                                                </span>
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-shopping-cart me-1"></i> Vendus: 49
                                                </span>
                                            </div>
                                        </div>
                                        <div class="AnalInvenIa-product-trend neutral">
                                            <i class="fas fa-equals"></i> 0%
                                        </div>
                                    </div>
                                    <div class="AnalInvenIa-product-ranking">
                                        <div class="AnalInvenIa-product-rank">5</div>
                                        <div class="AnalInvenIa-product-info">
                                            <div class="AnalInvenIa-product-name">Batterie externe 20000mAh</div>
                                            <div class="AnalInvenIa-product-stats">
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-box me-1"></i> Stock: 60
                                                </span>
                                                <span class="AnalInvenIa-product-stat">
                                                    <i class="fas fa-shopping-cart me-1"></i> Vendus: 42
                                                </span>
                                            </div>
                                        </div>
                                        <div class="AnalInvenIa-product-trend negative">
                                            <i class="fas fa-arrow-down"></i> 5%
                                        </div>
                                    </div>
                                </div>
                                <div class="AnalInvenIa-top-products" id="AnalInvenIa-profitable">
                                    <!-- Contenu pour les produits rentables -->
                                </div>
                                <div class="AnalInvenIa-top-products" id="AnalInvenIa-critical">
                                    <!-- Contenu pour les produits en état critique -->
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-end">
                            <button class="btn btn-sm btn-outline-primary" id="AnalInvenIa-viewAllProducts">
                                Voir tous les produits <i class="fas fa-arrow-right ms-1"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-bullseye me-2"></i> Prévisions principales
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-prediction-container">
                                <div class="AnalInvenIa-prediction-header">
                                    <div class="AnalInvenIa-prediction-title">Prévisions de ventes par catégorie</div>
                                    <div class="AnalInvenIa-prediction-period">
                                        <i class="fas fa-calendar-alt me-2"></i>Prochain mois
                                    </div>
                                </div>
                                <div class="AnalInvenIa-chart-container">
                                    <canvas id="AnalInvenIa-categoryPredictionChart"></canvas>
                                </div>
                                <div class="AnalInvenIa-prediction-insight">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    <span>L'IA prévoit une forte hausse des ventes d'électronique (+18%) pour le mois prochain.</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-end">
                            <button class="btn btn-sm btn-outline-primary" id="AnalInvenIa-viewAllPredictions">
                                Voir toutes les prévisions <i class="fas fa-arrow-right ms-1"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="AnalInvenIa-report-summary">
                <div class="AnalInvenIa-report-header">
                    <div class="AnalInvenIa-report-title">
                        <i class="fas fa-brain me-2"></i> Synthèse IA
                    </div>
                    <button class="AnalInvenIa-report-expand" id="AnalInvenIa-toggleSummary">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="AnalInvenIa-report-content" id="AnalInvenIa-summaryContent">
                    <p><strong>Performance globale : Excellente</strong></p>
                    <p>L'analyse de vos données d'inventaire pour le mois de Mai 2025 montre une tendance positive avec une augmentation des ventes de 12,3% par rapport au mois précédent. La valeur totale de votre stock a augmenté de 8,5%, indiquant un bon équilibre entre les entrées et sorties de stock.</p>
                    <p>Les <strong>points forts</strong> de votre inventaire :</p>
                    <p>• La catégorie Électronique continue de dominer vos ventes avec une croissance constante</p>
                    <p>• Votre rotation de stock s'est améliorée de 5% ce mois-ci</p>
                    <p>• Le produit "Smartphone XL+" montre une excellente performance avec une hausse de ventes de 15%</p>
                    <p>Les <strong>points d'attention</strong> :</p>
                    <p>• 3 produits sont en surstockage, représentant une valeur immobilisée de 5 420€</p>
                    <p>• 2 produits populaires risquent une rupture de stock dans les 10 prochains jours</p>
                    <p>• La catégorie "Accessoires gaming" montre une tendance à la baisse (-8%)</p>
                    <p>Notre IA recommande de concentrer vos efforts sur l'optimisation des niveaux de stock pour les produits à forte rotation et de réévaluer votre stratégie pour les produits en surstockage.</p>
                </div>
            </div>
        </div>
        
        <!-- Autres onglets -->
        <div class="AnalInvenIa-insight-content" id="AnalInvenIa-tab-stats">
            <!-- Contenu pour l'onglet Statistiques -->
        </div>
        <div class="AnalInvenIa-insight-content" id="AnalInvenIa-tab-products">
            <!-- Contenu pour l'onglet Produits -->
        </div>
        <div class="AnalInvenIa-insight-content" id="AnalInvenIa-tab-predictions">
            <!-- Contenu pour l'onglet Prévisions -->
        </div>
        <div class="AnalInvenIa-insight-content" id="AnalInvenIa-tab-recommendations">
            <!-- Contenu pour l'onglet Recommandations -->
        </div>
        <div class="AnalInvenIa-insight-content" id="AnalInvenIa-tab-reports">
            <!-- Contenu pour l'onglet Rapports -->
        </div>
        
    </div>
    
    <!-- Loader d'analyse -->
    <div id="AnalInvenIa-analyzeLoader" style="display: none;">
        <div class="AnalInvenIa-loader-container">
            <div class="AnalInvenIa-loader-content">
                <div class="AnalInvenIa-loader-animation">
                    <div class="AnalInvenIa-loader-brain">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="AnalInvenIa-loader-pulse"></div>
                </div>
                <div class="AnalInvenIa-loader-text">
                    <h3>Analyse IA en cours...</h3>
                    <p id="AnalInvenIa-loaderStatus">Analyse des données d'inventaire</p>
                    <div class="AnalInvenIa-loader-progress">
                        <div class="AnalInvenIa-loader-progress-bar" id="AnalInvenIa-loaderProgressBar"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<style>
  /* Styles pour la section d'analyse IA */
#AnalInvenIa-dashboard {
    background-color: #f8f9fa;
}

.AnalInvenIa-intro-card {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    background: linear-gradient(135deg, #0d6efd, #6610f2);
    border-radius: 10px;
    color: white;
    margin-bottom: 2rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.AnalInvenIa-intro-icon {
    font-size: 2.5rem;
    margin-right: 1.5rem;
    background-color: rgba(255, 255, 255, 0.2);
    width: 70px;
    height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.AnalInvenIa-intro-content h3 {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.AnalInvenIa-intro-content p {
    opacity: 0.9;
    margin-bottom: 0;
}

.AnalInvenIa-tabs {
    display: flex;
    background-color: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    margin-top: 0.5rem;
}

.AnalInvenIa-tab {
    padding: 0.75rem 1.25rem;
    cursor: pointer;
    flex: 1;
    text-align: center;
    font-weight: 500;
    transition: all 0.3s;
    border-bottom: 3px solid transparent;
}

.AnalInvenIa-tab.active {
    background-color: #f8f9fa;
    border-bottom: 3px solid var(--primary);
    color: var(--primary);
}

.AnalInvenIa-tab:hover:not(.active) {
    background-color: #f1f3f5;
}

.AnalInvenIa-tabs-small .AnalInvenIa-tab {
    padding: 0.5rem 0.75rem;
    font-size: 0.85rem;
}

.AnalInvenIa-filter-content {
    display: none;
    padding: 1rem;
    background-color: #f8f9fa;
    border-radius: 0 0 8px 8px;
}

.AnalInvenIa-filter-content.active {
    display: block;
}

.AnalInvenIa-select-container {
    position: relative;
    margin-bottom: 0.5rem;
}

.AnalInvenIa-select {
    position: relative;
    background-color: white;
    border: 1px solid #dee2e6;
    border-radius: 5px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.AnalInvenIa-select:hover {
    border-color: #adb5bd;
}

.AnalInvenIa-select-arrow {
    transition: transform 0.3s;
}

.AnalInvenIa-select.active .AnalInvenIa-select-arrow {
    transform: rotate(180deg);
}

.AnalInvenIa-select-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: white;
    border: 1px solid #dee2e6;
    border-top: none;
    border-radius: 0 0 5px 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.AnalInvenIa-select.active .AnalInvenIa-select-dropdown {
    display: block;
}

.AnalInvenIa-select-option {
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background 0.2s;
}

.AnalInvenIa-select-option:hover {
    background-color: #f8f9fa;
}

.AnalInvenIa-custom-filter {
    display: none;
    margin-top: 1rem;
}

.AnalInvenIa-custom-filter.active {
    display: block;
}

.AnalInvenIa-form-group {
    margin-bottom: 1rem;
}

.AnalInvenIa-form-group label {
    display: block;
    margin-bottom: 0.25rem;
    font-weight: 500;
}

.AnalInvenIa-scope-selector {
    display: flex;
    gap: 1rem;
    margin-top: 0.5rem;
}

.AnalInvenIa-scope-option {
    flex: 1;
    background-color: white;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
}

.AnalInvenIa-scope-option:hover {
    border-color: #adb5bd;
    transform: translateY(-2px);
}

.AnalInvenIa-scope-option.active {
    border-color: var(--primary);
    background-color: rgba(230, 0, 0, 0.05);
    box-shadow: 0 2px 8px rgba(230, 0, 0, 0.1);
}

.AnalInvenIa-scope-icon {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    color: var(--primary);
}

.AnalInvenIa-scope-label {
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.AnalInvenIa-scope-desc {
    font-size: 0.8rem;
    color: #6c757d;
}

.AnalInvenIa-search-container {
    position: relative;
}

.AnalInvenIa-search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: white;
    border: 1px solid #dee2e6;
    border-top: none;
    border-radius: 0 0 5px 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.AnalInvenIa-search-result {
    padding: 0.5rem 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #f1f3f5;
}

.AnalInvenIa-search-result:hover {
    background-color: #f8f9fa;
}

.AnalInvenIa-search-result:last-child {
    border-bottom: none;
}

.AnalInvenIa-selected-product {
    margin-top: 0.5rem;
}

.AnalInvenIa-product-badge {
    display: inline-flex;
    align-items: center;
    background-color: #e9ecef;
    padding: 0.5rem 0.75rem;
    border-radius: 50px;
}

.AnalInvenIa-remove-product {
    background: none;
    border: none;
    color: #6c757d;
    cursor: pointer;
    margin-left: 0.5rem;
    font-size: 0.8rem;
}

.AnalInvenIa-analysis-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid #dee2e6;
}

.AnalInvenIa-analysis-status {
    color: #6c757d;
}

.AnalInvenIa-results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.AnalInvenIa-results-title {
    font-size: 1.25rem;
    font-weight: 600;
    display: flex;
    align-items: center;
}

.AnalInvenIa-period-badge {
    background-color: #e9ecef;
    border-radius: 50px;
    padding: 0.25rem 0.75rem;
    font-size: 0.85rem;
    margin-left: 0.75rem;
}

.AnalInvenIa-insights-nav {
    display: flex;
    background-color: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    margin-bottom: 1.5rem;
}

.AnalInvenIa-insight-tab {
    padding: 1rem 1.25rem;
    cursor: pointer;
    flex: 1;
    text-align: center;
    font-weight: 500;
    transition: all 0.3s;
    border-bottom: 3px solid transparent;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.AnalInvenIa-insight-tab i {
    font-size: 1.25rem;
    margin-bottom: 0.5rem;
}

.AnalInvenIa-insight-tab.active {
    background-color: #f8f9fa;
    border-bottom: 3px solid var(--primary);
    color: var(--primary);
}

.AnalInvenIa-insight-tab:hover:not(.active) {
    background-color: #f1f3f5;
}

.AnalInvenIa-insight-content {
    display: none;
}

.AnalInvenIa-insight-content.active {
    display: block;
}

.AnalInvenIa-kpi-card {
    background-color: white;
    border-radius: 8px;
    padding: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    height: 100%;
}

.AnalInvenIa-kpi-icon {
    font-size: 2rem;
    width: 60px;
    height: 60px;
    background-color: rgba(13, 110, 253, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1.25rem;
    color: #0d6efd;
}

.AnalInvenIa-kpi-content {
    flex: 1;
}

.AnalInvenIa-kpi-value {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.AnalInvenIa-kpi-label {
    color: #6c757d;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.AnalInvenIa-kpi-trend {
    font-size: 0.85rem;
    font-weight: 500;
}

.AnalInvenIa-kpi-trend.positive {
    color: #198754;
}

.AnalInvenIa-kpi-trend.negative {
    color: #dc3545;
}

.AnalInvenIa-kpi-trend.neutral {
    color: #6c757d;
}

.AnalInvenIa-chart-container {
    height: 200px;
    position: relative;
}

.AnalInvenIa-chart-controls {
    display: flex;
    gap: 0.25rem;
}

.AnalInvenIa-chart-control {
    border: none;
    background: none;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    cursor: pointer;
    border-radius: 3px;
}

.AnalInvenIa-chart-control.active {
    background-color: #e9ecef;
    font-weight: 600;
}

.AnalInvenIa-recommendation-list {
    display: flex;
    flex-direction: column;
}

.AnalInvenIa-recommendation-item {
    display: flex;
    padding: 1rem;
    border-bottom: 1px solid #f1f3f5;
}

.AnalInvenIa-recommendation-item:last-child {
    border-bottom: none;
}

.AnalInvenIa-recommendation-icon {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    flex-shrink: 0;
}

.AnalInvenIa-recommendation-content {
    flex: 1;
}

.AnalInvenIa-recommendation-title {
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.AnalInvenIa-recommendation-description {
    font-size: 0.85rem;
    color: #6c757d;
}

.AnalInvenIa-top-products {
    display: none;
}

.AnalInvenIa-top-products.active {
    display: block;
}

.AnalInvenIa-product-ranking {
    display: flex;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid #f1f3f5;
}

.AnalInvenIa-product-ranking:last-child {
    border-bottom: none;
}

.AnalInvenIa-product-rank {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-right: 1rem;
    flex-shrink: 0;
}

.AnalInvenIa-product-info {
    flex: 1;
}

.AnalInvenIa-product-name {
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.AnalInvenIa-product-stats {
    display: flex;
    gap: 0.75rem;
    font-size: 0.8rem;
    color: #6c757d;
}

.AnalInvenIa-product-trend {
    font-weight: 600;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 5px;
}

.AnalInvenIa-product-trend.positive {
    color: #198754;
    background-color: rgba(25, 135, 84, 0.1);
}

.AnalInvenIa-product-trend.negative {
    color: #dc3545;
    background-color: rgba(220, 53, 69, 0.1);
}

.AnalInvenIa-product-trend.neutral {
    color: #6c757d;
    background-color: rgba(108, 117, 125, 0.1);
}

.AnalInvenIa-prediction-container {
    padding: 0.5rem;
}

.AnalInvenIa-prediction-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.AnalInvenIa-prediction-title {
    font-weight: 600;
}

.AnalInvenIa-prediction-period {
    font-size: 0.85rem;
    color: #6c757d;
}

.AnalInvenIa-prediction-insight {
    margin-top: 1rem;
    padding: 0.75rem;
    background-color: #f8f9fa;
    border-radius: 5px;
    font-size: 0.9rem;
}

.AnalInvenIa-report-summary {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    margin-top: 1.5rem;
}

.AnalInvenIa-report-header {
    padding: 1rem 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #f1f3f5;
}

.AnalInvenIa-report-title {
    font-weight: 600;
    font-size: 1.1rem;
}

.AnalInvenIa-report-expand {
    background: none;
    border: none;
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.AnalInvenIa-report-expand:hover {
    background-color: #f8f9fa;
}

.AnalInvenIa-report-content {
    padding: 1.5rem;
    font-size: 0.95rem;
    line-height: 1.5;
}

.AnalInvenIa-report-content p {
    margin-bottom: 0.75rem;
}

.AnalInvenIa-loader-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.AnalInvenIa-loader-content {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    padding: 2rem;
    text-align: center;
    max-width: 400px;
    width: 100%;
}

.AnalInvenIa-loader-animation {
    position: relative;
    margin-bottom: 1.5rem;
}

.AnalInvenIa-loader-brain {
    font-size: 3rem;
    color: var(--primary);
    margin-bottom: 1rem;
    animation: pulse 2s infinite;
}

.AnalInvenIa-loader-pulse {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background-color: rgba(230, 0, 0, 0.1);
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }
    50% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0.5;
    }
    100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }
}

.AnalInvenIa-loader-text h3 {
    margin-bottom: 0.5rem;
}

.AnalInvenIa-loader-progress {
    height: 8px;
    background-color: #f1f3f5;
    border-radius: 4px;
    margin-top: 1rem;
    overflow: hidden;
}

.AnalInvenIa-loader-progress-bar {
    height: 100%;
    width: 0%;
    background-color: var(--primary);
    border-radius: 4px;
    transition: width 0.3s;
}

/* Media queries pour la responsivité */
@media (max-width: 767px) {
    .AnalInvenIa-intro-card {
        flex-direction: column;
        text-align: center;
    }
    
    .AnalInvenIa-intro-icon {
        margin-right: 0;
        margin-bottom: 1rem;
    }
    
    .AnalInvenIa-scope-selector {
        flex-direction: column;
    }
    
    .AnalInvenIa-insights-nav {
        flex-wrap: wrap;
    }
    
    .AnalInvenIa-insight-tab {
        flex: auto;
        min-width: 33.33%;
    }
    
    .AnalInvenIa-tab-container {
        overflow-x: auto;
    }
    
    .AnalInvenIa-kpi-card,
    .AnalInvenIa-product-ranking,
    .AnalInvenIa-recommendation-item {
        padding: 0.75rem;
    }
    
    .AnalInvenIa-analysis-footer {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .AnalInvenIa-analysis-status {
        margin-bottom: 1rem;
    }
    
    .AnalInvenIa-results-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .AnalInvenIa-results-actions {
        margin-top: 1rem;
        width: 100%;
        display: flex;
        justify-content: space-between;
    }
}

/* Ajout d'icônes manquantes pour Font Awesome */
.fa-crystal-ball:before {
    content: "\f6e8"; /* fa-gem alternatif */
}

</style>


<script>
  // JavaScript pour l'analyse IA de l'inventaire
document.addEventListener('DOMContentLoaded', function() {
    // Variables pour gérer l'interface
    const analyzeBtn = document.getElementById('AnalInvenIa-runBtn');
    const filterTabs = document.querySelectorAll('.AnalInvenIa-tab[data-filter]');
    const customFilterTabs = document.querySelectorAll('.AnalInvenIa-tab[data-customfilter]');
    const scopeOptions = document.querySelectorAll('.AnalInvenIa-scope-option');
    const selects = document.querySelectorAll('.AnalInvenIa-select');
    const insightTabs = document.querySelectorAll('.AnalInvenIa-insight-tab');
    const topProductTabs = document.querySelectorAll('.AnalInvenIa-tab[data-toptab]');
    const newAnalysisBtn = document.getElementById('AnalInvenIa-newAnalysis');
    const resetParamsBtn = document.getElementById('AnalInvenIa-resetParams');
    const toggleSummaryBtn = document.getElementById('AnalInvenIa-toggleSummary');

    // Configuration du sélecteur de catégorie
    const categorySelector = document.getElementById('AnalInvenIa-categorySelector');
    const productSelector = document.getElementById('AnalInvenIa-productSelector');
    
    // Gestion des onglets de filtres
    filterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const filterId = this.getAttribute('data-filter');
            
            // Désactiver tous les onglets et contenus
            filterTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-filter-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-filter${filterId}`).classList.add('active');
        });
    });
    
    // Gestion des onglets de filtres personnalisés
    customFilterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const customFilterId = this.getAttribute('data-customfilter');
            
            // Désactiver tous les onglets et contenus
            customFilterTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-custom-filter').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-custom${customFilterId.charAt(0).toUpperCase() + customFilterId.slice(1)}`).classList.add('active');
        });
    });
    
    // Gestion des options de portée d'analyse
    scopeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const scope = this.getAttribute('data-scope');
            
            // Désactiver toutes les options
            scopeOptions.forEach(opt => opt.classList.remove('active'));
            
            // Activer l'option sélectionnée
            this.classList.add('active');
            
            // Afficher/masquer les sélecteurs appropriés
            categorySelector.style.display = scope === 'category' ? 'block' : 'none';
            productSelector.style.display = scope === 'product' ? 'block' : 'none';
        });
    });
    
    // Gestion des select personnalisés
    selects.forEach(select => {
        select.addEventListener('click', function() {
            this.classList.toggle('active');
        });
        
        const options = select.querySelectorAll('.AnalInvenIa-select-option');
        options.forEach(option => {
            option.addEventListener('click', function(e) {
                e.stopPropagation();
                const value = this.textContent.trim();
                select.querySelector('.AnalInvenIa-select-value').textContent = value;
                select.classList.remove('active');
            });
        });
    });
    
    // Fermer les selects lors d'un clic à l'extérieur
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.AnalInvenIa-select')) {
            selects.forEach(select => select.classList.remove('active'));
        }
    });
    
    // Gestion des onglets d'insights
    insightTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            
            // Désactiver tous les onglets et contenus
            insightTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-insight-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-tab-${tabId}`).classList.add('active');
        });
    });
    
    // Gestion des onglets de top produits
    topProductTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-toptab');
            
            // Désactiver tous les onglets et contenus
            topProductTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-top-products').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-${tabId}`).classList.add('active');
        });
    });
    
    // Gestion du bouton d'analyse
    if (analyzeBtn) {
        analyzeBtn.addEventListener('click', function() {
            startAnalysis();
        });
    }
    
    // Gestion du bouton de réinitialisation
    if (resetParamsBtn) {
        resetParamsBtn.addEventListener('click', function() {
            resetAnalysisParams();
        });
    }
    
    // Gestion du bouton de nouvelle analyse
    if (newAnalysisBtn) {
        newAnalysisBtn.addEventListener('click', function() {
            document.getElementById('AnalInvenIa-results').style.display = 'none';
            document.querySelector('.card').style.display = 'block';
        });
    }
    
    // Gestion du bouton pour développer/réduire le résumé
    if (toggleSummaryBtn) {
        toggleSummaryBtn.addEventListener('click', function() {
            const summaryContent = document.getElementById('AnalInvenIa-summaryContent');
            const isExpanded = summaryContent.style.display !== 'none';
            
            if (isExpanded) {
                summaryContent.style.display = 'none';
                this.innerHTML = '<i class="fas fa-chevron-down"></i>';
            } else {
                summaryContent.style.display = 'block';
                this.innerHTML = '<i class="fas fa-chevron-up"></i>';
            }
        });
    }
    
    // Simuler l'analyse IA
    function startAnalysis() {
        const loaderEl = document.getElementById('AnalInvenIa-analyzeLoader');
        const progressBar = document.getElementById('AnalInvenIa-loaderProgressBar');
        const statusEl = document.getElementById('AnalInvenIa-loaderStatus');
        
        document.querySelector('.card').style.display = 'none';
        loaderEl.style.display = 'block';
        
        let progress = 0;
        const progressSteps = [
            { percent: 10, message: "Collecte des données d'inventaire..." },
            { percent: 30, message: "Analyse des tendances de vente..." },
            { percent: 50, message: "Calcul des prévisions..." },
            { percent: 70, message: "Génération des recommandations..." },
            { percent: 90, message: "Finalisation du rapport d'analyse..." },
            { percent: 100, message: "Analyse terminée!" }
        ];
        
        let currentStep = 0;
        
        const interval = setInterval(() => {
            if (currentStep < progressSteps.length) {
                const step = progressSteps[currentStep];
                progress = step.percent;
                progressBar.style.width = `${progress}%`;
                statusEl.textContent = step.message;
                currentStep++;
                
                if (currentStep === progressSteps.length) {
                    setTimeout(() => {
                        clearInterval(interval);
                        loaderEl.style.display = 'none';
                        document.getElementById('AnalInvenIa-results').style.display = 'block';
                        
                        // Initialiser les graphiques
                        initCharts();
                    }, 800);
                }
            }
        }, 800);
    }
    
    // Fonction pour initialiser les graphiques
    function initCharts() {
        // Cette fonction sera complétée ultérieurement avec Chart.js
        console.log("Initialisation des graphiques");
    }
    
    // Fonction pour réinitialiser les paramètres d'analyse
    function resetAnalysisParams() {
        // Réinitialiser les filtres
        filterTabs[0].click();
        customFilterTabs[0].click();
        
        // Réinitialiser la portée
        scopeOptions[0].click();
        
        // Réinitialiser les selects
        selects.forEach(select => {
            const defaultOption = select.querySelector('.AnalInvenIa-select-option');
            if (defaultOption) {
                const defaultValue = defaultOption.textContent.trim();
                select.querySelector('.AnalInvenIa-select-value').textContent = defaultValue;
            }
        });
    }
    
    // Gestion de la barre latérale
    const sidebarItems = document.querySelectorAll('.nav-item');
    sidebarItems.forEach(item => {
        item.addEventListener('click', function() {
            // Désactiver tous les éléments
            sidebarItems.forEach(i => i.classList.remove('active'));
            
            // Activer l'élément cliqué
            this.classList.add('active');
            
            // Cacher toutes les sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Afficher la section correspondante
            const sectionId = this.getAttribute('data-section');
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
            }
        });
    });
});

</script>

<conclusion>
  ## 5. Instructions d'ajout

Pour implémenter ces éléments dans votre application :

1. Ajoutez l'élément de menu dans la barre latérale, juste après "Tableau de bord"
2. Ajoutez la section `AnalInvenIa-dashboard` complète dans la div avec id "content"
3. Ajoutez le CSS à votre feuille de style
4. Ajoutez le JavaScript à vos scripts existants

Ces ajouts créeront une interface d'analyse IA moderne, intuitive et visuellement attrayante pour votre système de gestion d'inventaire. L'interface propose des filtres de période flexibles, des options de portée d'analyse (global, par catégorie, par produit) et affiche des résultats complets avec graphiques, recommandations, classements de produits et prévisions.

Pour compléter l'intégration, nous ajouterons dans une phase ultérieure le JavaScript avancé pour générer les graphiques avec Chart.js et simuler le fonctionnement complet de l'IA d'analyse.

</conclusion>


<script>
  // JavaScript complet pour l'analyse IA de l'inventaire
document.addEventListener('DOMContentLoaded', function() {
    // ====== Données de simulation ======
    const mockProducts = [
        { id: 1, name: "Smartphone XL+", category: "electronics", stock: 32, sold: 78, price: 899, trend: 15 },
        { id: 2, name: "Écouteurs sans fil Pro", category: "electronics", stock: 45, sold: 64, price: 199, trend: 12 },
        { id: 3, name: "Montre connectée Sport", category: "electronics", stock: 28, sold: 52, price: 299, trend: 8 },
        { id: 4, name: "Enceinte portable waterproof", category: "electronics", stock: 40, sold: 49, price: 129, trend: 0 },
        { id: 5, name: "Batterie externe 20000mAh", category: "electronics", stock: 60, sold: 42, price: 59, trend: -5 },
        { id: 6, name: "Casque gaming standard", category: "electronics", stock: 35, sold: 10, price: 89, trend: -15 },
        { id: 7, name: "Table de salon design", category: "furniture", stock: 12, sold: 8, price: 349, trend: 3 },
        { id: 8, name: "Chaise de bureau ergonomique", category: "furniture", stock: 18, sold: 15, price: 249, trend: 5 },
        { id: 9, name: "T-shirt Premium", category: "clothing", stock: 120, sold: 85, price: 29, trend: -2 },
        { id: 10, name: "Jeans coupe slim", category: "clothing", stock: 80, sold: 62, price: 59, trend: 4 },
        { id: 11, name: "Snacks assortis", category: "food", stock: 150, sold: 130, price: 3.5, trend: 10 },
        { id: 12, name: "Boissons énergisantes", category: "food", stock: 200, sold: 180, price: 2.5, trend: 8 }
    ];

    const mockCategories = [
        { id: "electronics", name: "Électronique", icon: "fas fa-tv", prediction: 18 },
        { id: "furniture", name: "Mobilier", icon: "fas fa-couch", prediction: 5 },
        { id: "clothing", name: "Vêtements", icon: "fas fa-tshirt", prediction: -2 },
        { id: "food", name: "Alimentaire", icon: "fas fa-utensils", prediction: 10 }
    ];

    const mockSalesData = {
        week: [42, 38, 52, 48, 62, 59, 78],
        month: [150, 165, 180, 168, 172, 190, 185, 210, 195, 215, 220, 225, 230, 218, 225, 240, 235, 250, 242, 265, 260, 270, 275, 290, 285, 295, 300, 310, 320, 325],
        year: [3200, 3500, 3800, 4100, 4300, 4600, 4900, 5200, 5500, 5800, 5950, 6100]
    };

    const mockRecommendations = [
        { id: 1, type: "increase_stock", icon: "fas fa-arrow-up", title: "Augmenter le stock de Smartphone XL+", description: "Les ventes augmentent de 15% chaque mois depuis 3 mois." },
        { id: 2, type: "price_up", icon: "fas fa-percentage", title: "Augmenter le prix des Écouteurs sans fil Pro", description: "Forte demande avec une élasticité-prix favorable. Potentiel +15% sans impact sur les ventes." },
        { id: 3, type: "reduce_stock", icon: "fas fa-arrow-down", title: "Réduire le stock de Casques gaming standard", description: "Rotation lente, 35 unités en stock depuis plus de 60 jours." },
        { id: 4, type: "restock", icon: "fas fa-exclamation-triangle", title: "Réapprovisionner en Montre connectée Sport", description: "Stock faible (28) et ventes en hausse. Risque de rupture dans 15 jours." },
        { id: 5, type: "promotion", icon: "fas fa-tags", title: "Lancer une promotion sur Batterie externe 20000mAh", description: "Baisse des ventes de 5% et stock important. Promotion recommandée pour accélérer l'écoulement." },
        { id: 6, type: "bundle", icon: "fas fa-box-open", title: "Créer un bundle Smartphone + Écouteurs", description: "Ces produits sont souvent achetés ensemble. Un bundle augmenterait la valeur moyenne des commandes." }
    ];

    // ====== Éléments DOM ======
    const analyzeBtn = document.getElementById('AnalInvenIa-runBtn');
    const filterTabs = document.querySelectorAll('.AnalInvenIa-tab[data-filter]');
    const customFilterTabs = document.querySelectorAll('.AnalInvenIa-tab[data-customfilter]');
    const scopeOptions = document.querySelectorAll('.AnalInvenIa-scope-option');
    const selects = document.querySelectorAll('.AnalInvenIa-select');
    const insightTabs = document.querySelectorAll('.AnalInvenIa-insight-tab');
    const topProductTabs = document.querySelectorAll('.AnalInvenIa-tab[data-toptab]');
    const newAnalysisBtn = document.getElementById('AnalInvenIa-newAnalysis');
    const resetParamsBtn = document.getElementById('AnalInvenIa-resetParams');
    const toggleSummaryBtn = document.getElementById('AnalInvenIa-toggleSummary');

    // Configuration des éléments spécifiques
    const categorySelector = document.getElementById('AnalInvenIa-categorySelector');
    const productSelector = document.getElementById('AnalInvenIa-productSelector');
    const productSearchInput = document.getElementById('AnalInvenIa-productSearch');
    const productResults = document.getElementById('AnalInvenIa-productResults');
    const selectedProductDisplay = document.querySelector('.AnalInvenIa-selected-product');
    const selectedProductName = document.getElementById('AnalInvenIa-selectedProductName');
    const analysisTitle = document.getElementById('AnalInvenIa-analysisTitle');
    const analysisPeriod = document.getElementById('AnalInvenIa-analysisPeriod');
    const printResultsBtn = document.getElementById('AnalInvenIa-printResults');
    const exportResultsBtn = document.getElementById('AnalInvenIa-exportResults');
    const viewAllRecommendationsBtn = document.getElementById('AnalInvenIa-viewAllRecommendations');
    const viewAllProductsBtn = document.getElementById('AnalInvenIa-viewAllProducts');
    const viewAllPredictionsBtn = document.getElementById('AnalInvenIa-viewAllPredictions');
    const chartControls = document.querySelectorAll('.AnalInvenIa-chart-control');

    // Variables d'état
    let currentFilter = 1;
    let currentCustomFilter = 'range';
    let currentScope = 'global';
    let selectedCategory = null;
    let selectedProduct = null;
    let currentInterval = 'day';
    let currentRelativePeriod = 'today';
    let currentChartPeriod = 'month';
    let charts = {};

    // ====== Initialisation ======
    // Remplir les sélecteurs de catégories
    initCategorySelectors();
    
    // Préparer le champ de recherche de produits
    initProductSearch();

    // ====== Gestion des événements ======
    // Gestion des onglets de filtres
    filterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const filterId = this.getAttribute('data-filter');
            currentFilter = parseInt(filterId);
            
            // Désactiver tous les onglets et contenus
            filterTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-filter-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-filter${filterId}`).classList.add('active');
        });
    });
    
    // Gestion des onglets de filtres personnalisés
    customFilterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const customFilterId = this.getAttribute('data-customfilter');
            currentCustomFilter = customFilterId;
            
            // Désactiver tous les onglets et contenus
            customFilterTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-custom-filter').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-custom${customFilterId.charAt(0).toUpperCase() + customFilterId.slice(1)}`).classList.add('active');
        });
    });
    
    // Gestion des options de portée d'analyse
    scopeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const scope = this.getAttribute('data-scope');
            currentScope = scope;
            
            // Désactiver toutes les options
            scopeOptions.forEach(opt => opt.classList.remove('active'));
            
            // Activer l'option sélectionnée
            this.classList.add('active');
            
            // Afficher/masquer les sélecteurs appropriés
            categorySelector.style.display = scope === 'category' ? 'block' : 'none';
            productSelector.style.display = scope === 'product' ? 'block' : 'none';
        });
    });
    
    // Gestion des select personnalisés
    selects.forEach(select => {
        const selectId = select.id;
        
        select.addEventListener('click', function() {
            this.classList.toggle('active');
        });
        
        const options = select.querySelectorAll('.AnalInvenIa-select-option');
        options.forEach(option => {
            option.addEventListener('click', function(e) {
                e.stopPropagation();
                const value = this.getAttribute('data-value');
                const displayText = this.textContent.trim();
                
                // Mettre à jour l'affichage du sélecteur
                const valueDisplay = select.querySelector('.AnalInvenIa-select-value');
                
                if (selectId === 'AnalInvenIa-intervalSelect') {
                    currentInterval = value;
                    const icon = this.querySelector('i').className;
                    valueDisplay.innerHTML = `<i class="${icon} me-2"></i>${displayText}`;
                } else if (selectId === 'AnalInvenIa-relativeSelect') {
                    currentRelativePeriod = value;
                    const icon = this.querySelector('i').className;
                    valueDisplay.innerHTML = `<i class="${icon} me-2"></i>${displayText}`;
                } else if (selectId === 'AnalInvenIa-categorySelect') {
                    selectedCategory = value;
                    const icon = this.querySelector('i').className;
                    valueDisplay.innerHTML = `<i class="${icon} me-2"></i>${displayText}`;
                } else {
                    valueDisplay.textContent = displayText;
                }
                
                select.classList.remove('active');
            });
        });
    });
    
    // Fermer les selects lors d'un clic à l'extérieur
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.AnalInvenIa-select')) {
            selects.forEach(select => select.classList.remove('active'));
        }
        if (!e.target.closest('.AnalInvenIa-search-container') && productResults) {
            productResults.style.display = 'none';
        }
    });
    
    // Gestion des onglets d'insights
    insightTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            
            // Désactiver tous les onglets et contenus
            insightTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-insight-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-tab-${tabId}`).classList.add('active');
        });
    });
    
    // Gestion des onglets de top produits
    topProductTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-toptab');
            
            // Désactiver tous les onglets et contenus
            topProductTabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.AnalInvenIa-top-products').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet et le contenu sélectionnés
            this.classList.add('active');
            document.getElementById(`AnalInvenIa-${tabId}`).classList.add('active');
            
            // Remplir le contenu si nécessaire
            fillTopProductsContent(tabId);
        });
    });
    
    // Gestion du bouton d'analyse
    analyzeBtn.addEventListener('click', function() {
        startAnalysis();
    });
    
    document.getElementById('AnalInvenIa-runAnalysis').addEventListener('click', function() {
        startAnalysis();
    });
    
    // Gestion du bouton de réinitialisation
    resetParamsBtn.addEventListener('click', function() {
        resetAnalysisParams();
    });
    
    // Gestion du bouton de nouvelle analyse
    newAnalysisBtn.addEventListener('click', function() {
        document.getElementById('AnalInvenIa-results').style.display = 'none';
        document.querySelector('.card').style.display = 'block';
    });
    
    // Gestion du bouton pour développer/réduire le résumé
    toggleSummaryBtn.addEventListener('click', function() {
        const summaryContent = document.getElementById('AnalInvenIa-summaryContent');
        const isCollapsed = summaryContent.style.maxHeight === '0px' || !summaryContent.style.maxHeight;
        
        if (isCollapsed) {
            summaryContent.style.maxHeight = summaryContent.scrollHeight + 'px';
            this.innerHTML = '<i class="fas fa-chevron-up"></i>';
        } else {
            summaryContent.style.maxHeight = '0px';
            this.innerHTML = '<i class="fas fa-chevron-down"></i>';
        }
    });

    // Gestion de la suppression d'un produit sélectionné
    const removeProductBtn = document.querySelector('.AnalInvenIa-remove-product');
    if (removeProductBtn) {
        removeProductBtn.addEventListener('click', function() {
            selectedProduct = null;
            selectedProductDisplay.style.display = 'none';
        });
    }

    // Gestion des contrôles des graphiques
    chartControls.forEach(control => {
        control.addEventListener('click', function() {
            const period = this.getAttribute('data-period');
            currentChartPeriod = period;
            
            // Mettre à jour l'état actif
            chartControls.forEach(c => c.classList.remove('active'));
            this.classList.add('active');
            
            // Mettre à jour le graphique
            updateSalesChart(period);
        });
    });

    // Gestion des boutons d'action des résultats
    if (printResultsBtn) {
        printResultsBtn.addEventListener('click', function() {
            alert("Fonctionnalité d'impression: cette fonctionnalité sera implémentée ultérieurement.");
        });
    }
    
    if (exportResultsBtn) {
        exportResultsBtn.addEventListener('click', function() {
            alert("Fonctionnalité d'export PDF: cette fonctionnalité sera implémentée ultérieurement.");
        });
    }

    if (viewAllRecommendationsBtn) {
        viewAllRecommendationsBtn.addEventListener('click', function() {
            // Activer l'onglet Recommandations
            document.querySelector('.AnalInvenIa-insight-tab[data-tab="recommendations"]').click();
            fillRecommendationsTab();
        });
    }

    if (viewAllProductsBtn) {
        viewAllProductsBtn.addEventListener('click', function() {
            // Activer l'onglet Produits
            document.querySelector('.AnalInvenIa-insight-tab[data-tab="products"]').click();
            fillProductsTab();
        });
    }

    if (viewAllPredictionsBtn) {
        viewAllPredictionsBtn.addEventListener('click', function() {
            // Activer l'onglet Prévisions
            document.querySelector('.AnalInvenIa-insight-tab[data-tab="predictions"]').click();
            fillPredictionsTab();
        });
    }

    // Gestion de la barre latérale
    const sidebarItems = document.querySelectorAll('.nav-item');
    sidebarItems.forEach(item => {
        item.addEventListener('click', function() {
            // Désactiver tous les éléments
            sidebarItems.forEach(i => i.classList.remove('active'));
            
            // Activer l'élément cliqué
            this.classList.add('active');
            
            // Cacher toutes les sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Afficher la section correspondante
            const sectionId = this.getAttribute('data-section');
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
            }
        });
    });

    // ====== Fonctions ======
    // Initialiser les sélecteurs de catégories
    function initCategorySelectors() {
        const categorySelect = document.getElementById('AnalInvenIa-categorySelect');
        const dropdown = categorySelect.querySelector('.AnalInvenIa-select-dropdown');
        
        // Vider le dropdown existant
        dropdown.innerHTML = '';
        
        // Ajouter les catégories
        mockCategories.forEach(category => {
            const option = document.createElement('div');
            option.className = 'AnalInvenIa-select-option';
            option.setAttribute('data-value', category.id);
            option.innerHTML = `<i class="${category.icon} me-2"></i>${category.name}`;
            dropdown.appendChild(option);
            
            option.addEventListener('click', function(e) {
                e.stopPropagation();
                selectedCategory = category.id;
                categorySelect.querySelector('.AnalInvenIa-select-value').innerHTML = `<i class="${category.icon} me-2"></i>${category.name}`;
                categorySelect.classList.remove('active');
            });
        });
    }

    // Initialiser la recherche de produits
    function initProductSearch() {
        if (!productSearchInput) return;
        
        productSearchInput.addEventListener('input', function() {
            const searchTerm = this.value.trim().toLowerCase();
            
            if (searchTerm.length < 2) {
                productResults.style.display = 'none';
                return;
            }
            
            // Filtrer les produits
            const matchingProducts = mockProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm)
            );
            
            // Afficher les résultats
            displayProductSearchResults(matchingProducts);
        });
        
        productSearchInput.addEventListener('focus', function() {
            if (this.value.trim().length >= 2) {
                productResults.style.display = 'block';
            }
        });
    }

    // Afficher les résultats de recherche de produits
    function displayProductSearchResults(products) {
        if (!productResults) return;
        
        productResults.innerHTML = '';
        
        if (products.length === 0) {
            productResults.innerHTML = '<div class="AnalInvenIa-search-no-results">Aucun produit trouvé</div>';
            productResults.style.display = 'block';
            return;
        }
        
        products.forEach(product => {
            const resultItem = document.createElement('div');
            resultItem.className = 'AnalInvenIa-search-result';
            resultItem.innerHTML = `
                <i class="fas fa-box me-2"></i>
                <span>${product.name}</span>
                <span class="AnalInvenIa-result-stock">Stock: ${product.stock}</span>
            `;
            
            resultItem.addEventListener('click', function() {
                selectedProduct = product;
                productSearchInput.value = '';
                productResults.style.display = 'none';
                
                // Afficher le produit sélectionné
                selectedProductName.textContent = product.name;
                selectedProductDisplay.style.display = 'block';
            });
            
            productResults.appendChild(resultItem);
        });
        
        productResults.style.display = 'block';
    }

    // Démarrer l'analyse
    function startAnalysis() {
        const loaderEl = document.getElementById('AnalInvenIa-analyzeLoader');
        const progressBar = document.getElementById('AnalInvenIa-loaderProgressBar');
        const statusEl = document.getElementById('AnalInvenIa-loaderStatus');
        const resultsEl = document.getElementById('AnalInvenIa-results');
        
        // Cacher les paramètres et afficher le loader
        document.querySelector('.card').style.display = 'none';
        loaderEl.style.display = 'block';
        
        // Préparer le titre de l'analyse
        updateAnalysisTitle();
        
        // Simuler le chargement
        let progress = 0;
        const progressSteps = [
            { percent: 10, message: "Collecte des données d'inventaire..." },
            { percent: 30, message: "Analyse des tendances de vente..." },
            { percent: 50, message: "Calcul des prévisions..." },
            { percent: 70, message: "Génération des recommandations..." },
            { percent: 90, message: "Finalisation du rapport d'analyse..." },
            { percent: 100, message: "Analyse terminée!" }
        ];
        
        let currentStep = 0;
        progressBar.style.width = '0%';
        
        const interval = setInterval(() => {
            if (currentStep < progressSteps.length) {
                const step = progressSteps[currentStep];
                progress = step.percent;
                progressBar.style.width = `${progress}%`;
                statusEl.textContent = step.message;
                currentStep++;
                
                if (currentStep === progressSteps.length) {
                    setTimeout(() => {
                        clearInterval(interval);
                        loaderEl.style.display = 'none';
                        resultsEl.style.display = 'block';
                        
                        // Mettre à jour le contenu des onglets
                        fillOverviewTab();
                        updateProfitableTab();
                        updateCriticalTab();
                        
                        // Initialiser les graphiques
                        initCharts();
                    }, 800);
                }
            }
        }, 800);
    }

    // Mettre à jour le titre de l'analyse
    function updateAnalysisTitle() {
        let title = "";
        let period = "";
        
        // Déterminer la portée
        if (currentScope === 'global') {
            title = "Analyse globale de l'inventaire";
        } else if (currentScope === 'category' && selectedCategory) {
            const category = mockCategories.find(cat => cat.id === selectedCategory);
            title = `Analyse de la catégorie ${category ? category.name : ''}`;
        } else if (currentScope === 'product' && selectedProduct) {
            title = `Analyse du produit ${selectedProduct.name}`;
        } else {
            title = "Analyse de l'inventaire";
        }
        
        // Déterminer la période
        const now = new Date();
        
        if (currentFilter === 1) { // Intervalles
            if (currentInterval === 'day') {
                period = "Journalier - " + formatDate(now);
            } else if (currentInterval === 'week') {
                period = "Hebdomadaire - Semaine du " + formatDate(new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000));
            } else if (currentInterval === 'month') {
                period = "Mensuel - " + getMonthName(now.getMonth()) + " " + now.getFullYear();
            } else if (currentInterval === 'year') {
                period = "Annuel - " + now.getFullYear();
            } else {
                period = "Horaire - " + formatTime(now);
            }
        } else if (currentFilter === 2) { // Période relative
            if (currentRelativePeriod === 'now') {
                period = "À l'instant";
            } else if (currentRelativePeriod === 'today') {
                period = "Aujourd'hui - " + formatDate(now);
            } else if (currentRelativePeriod === 'yesterday') {
                const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);
                period = "Hier - " + formatDate(yesterday);
            } else if (currentRelativePeriod === 'thisWeek') {
                period = "Cette semaine";
            } else if (currentRelativePeriod === 'lastWeek') {
                period = "Semaine dernière";
            } else if (currentRelativePeriod === 'thisMonth') {
                period = "Ce mois - " + getMonthName(now.getMonth()) + " " + now.getFullYear();
            } else if (currentRelativePeriod === 'lastMonth') {
                let lastMonth = now.getMonth() - 1;
                let year = now.getFullYear();
                if (lastMonth < 0) {
                    lastMonth = 11;
                    year--;
                }
                period = "Mois dernier - " + getMonthName(lastMonth) + " " + year;
            } else if (currentRelativePeriod === 'thisYear') {
                period = "Cette année - " + now.getFullYear();
            } else if (currentRelativePeriod === 'lastYear') {
                period = "Année dernière - " + (now.getFullYear() - 1);
            }
        } else if (currentFilter === 3) { // Personnalisé
            if (currentCustomFilter === 'range') {
                const startDate = document.getElementById('AnalInvenIa-startDate').value;
                const endDate = document.getElementById('AnalInvenIa-endDate').value;
                period = startDate && endDate ? `Du ${startDate} au ${endDate}` : "Période personnalisée";
            } else if (currentCustomFilter === 'year') {
                const yearSelect = document.getElementById('AnalInvenIa-yearSelect');
                const yearValue = yearSelect.querySelector('.AnalInvenIa-select-value').textContent.trim();
                period = `Année ${yearValue}`;
            } else if (currentCustomFilter === 'month') {
                const monthSelect = document.getElementById('AnalInvenIa-monthSelect');
                const yearSelect = document.getElementById('AnalInvenIa-yearForMonthSelect');
                const monthValue = monthSelect.querySelector('.AnalInvenIa-select-value').textContent.trim();
                const yearValue = yearSelect.querySelector('.AnalInvenIa-select-value').textContent.trim();
                period = `${monthValue} ${yearValue}`;
            } else if (currentCustomFilter === 'day') {
                const dayInput = document.getElementById('AnalInvenIa-day').value;
                const monthSelect = document.getElementById('AnalInvenIa-monthForDaySelect');
                const yearSelect = document.getElementById('AnalInvenIa-yearForDaySelect');
                const monthValue = monthSelect.querySelector('.AnalInvenIa-select-value').textContent.trim();
                const yearValue = yearSelect.querySelector('.AnalInvenIa-select-value').textContent.trim();
                period = `${dayInput} ${monthValue} ${yearValue}`;
            }
        }
        
        analysisTitle.textContent = title;
        analysisPeriod.textContent = period;
    }

    // Initialiser les graphiques
    function initCharts() {
        // Graphique d'évolution des ventes
        updateSalesChart(currentChartPeriod);
        
        // Graphique des prévisions par catégorie
        const ctx2 = document.getElementById('AnalInvenIa-categoryPredictionChart');
        if (ctx2) {
            const categoryLabels = mockCategories.map(cat => cat.name);
            const predictionData = mockCategories.map(cat => cat.prediction);
            
            charts.categoryPrediction = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: categoryLabels,
                    datasets: [{
                        label: 'Prévision de croissance (%)',
                        data: predictionData,
                        backgroundColor: predictionData.map(value => value >= 0 ? 'rgba(75, 192, 192, 0.6)' : 'rgba(255, 99, 132, 0.6)'),
                        borderColor: predictionData.map(value => value >= 0 ? 'rgb(75, 192, 192)' : 'rgb(255, 99, 132)'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    // Mettre à jour le graphique des ventes
    function updateSalesChart(period) {
        const ctx = document.getElementById('AnalInvenIa-salesChart');
        if (!ctx) return;
        
        // Préparer les données selon la période
        let labels, data;
        
        if (period === 'week') {
            labels = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];
            data = mockSalesData.week;
        } else if (period === 'month') {
            labels = Array.from({ length: 30 }, (_, i) => i + 1);
            data = mockSalesData.month;
        } else if (period === 'year') {
            labels = ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Déc'];
            data = mockSalesData.year;
        }
        
        // Créer ou mettre à jour le graphique
        if (charts.sales) {
            charts.sales.data.labels = labels;
            charts.sales.data.datasets[0].data = data;
            charts.sales.update();
        } else {
            charts.sales = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Ventes (€)',
                        data: data,
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        pointRadius: 3,
                        pointBackgroundColor: 'rgba(54, 162, 235, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '€';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + '€';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    // Remplir l'onglet Aperçu
    function fillOverviewTab() {
        // Mettre à jour les KPIs
        document.getElementById('AnalInvenIa-totalValue').textContent = '24 850';
        document.getElementById('AnalInvenIa-salesValue').textContent = '12 450';
        document.getElementById('AnalInvenIa-stockIssues').textContent = '5';
        
        // Onglet par défaut pour les produits
        fillTopProductsContent('bestsellers');
    }

    // Remplir le contenu des top produits
    function fillTopProductsContent(tabId) {
        if (tabId === 'bestsellers') {
            // Déjà rempli dans le HTML statique
        } else if (tabId === 'profitable') {
            const profitableEl = document.getElementById('AnalInvenIa-profitable');
            if (!profitableEl) return;
            
            // Trier les produits par rentabilité (approximative)
            const profitableProducts = [...mockProducts]
                .sort((a, b) => (b.price * b.sold) - (a.price * a.sold))
                .slice(0, 5);
            
            profitableEl.innerHTML = '';
            
            profitableProducts.forEach((product, index) => {
                const profit = product.price * product.sold;
                const trenDirection = product.trend >= 0 ? 'positive' : 'negative';
                const trendIcon = product.trend > 0 ? 'fa-arrow-up' : product.trend < 0 ? 'fa-arrow-down' : 'fa-equals';
                
                const productEl = document.createElement('div');
                productEl.className = 'AnalInvenIa-product-ranking';
                productEl.innerHTML = `
                    <div class="AnalInvenIa-product-rank">${index + 1}</div>
                    <div class="AnalInvenIa-product-info">
                        <div class="AnalInvenIa-product-name">${product.name}</div>
                        <div class="AnalInvenIa-product-stats">
                            <span class="AnalInvenIa-product-stat">
                                <i class="fas fa-euro-sign me-1"></i> Profit: ${profit}€
                            </span>
                            <span class="AnalInvenIa-product-stat">
                                <i class="fas fa-shopping-cart me-1"></i> Vendus: ${product.sold}
                            </span>
                        </div>
                    </div>
                    <div class="AnalInvenIa-product-trend ${trenDirection}">
                        <i class="fas ${trendIcon}"></i> ${Math.abs(product.trend)}%
                    </div>
                `;
                
                profitableEl.appendChild(productEl);
            });
        } else if (tabId === 'critical') {
            const criticalEl = document.getElementById('AnalInvenIa-critical');
            if (!criticalEl) return;
            
            // Filtrer les produits en situation critique (stocks faibles avec ventes élevées ou surstockage)
            const criticalProducts = mockProducts.filter(product => 
                (product.stock < 15 && product.sold > 40) || // rupture probable
                (product.stock > 50 && product.sold < 20)    // surstockage
            ).slice(0, 5);
            
            criticalEl.innerHTML = '';
            
            criticalProducts.forEach((product, index) => {
                const isSurplus = product.stock > 50 && product.sold < 20;
                const statusClass = isSurplus ? 'surplus' : 'shortage';
                const statusIcon = isSurplus ? 'fa-boxes-stacked' : 'fa-triangle-exclamation';
                const statusText = isSurplus ? 'Surstockage' : 'Rupture probable';
                
                const productEl = document.createElement('div');
                productEl.className = 'AnalInvenIa-product-ranking';
                productEl.innerHTML = `
                    <div class="AnalInvenIa-product-rank">${index + 1}</div>
                    <div class="AnalInvenIa-product-info">
                        <div class="AnalInvenIa-product-name">${product.name}</div>
                        <div class="AnalInvenIa-product-stats">
                            <span class="AnalInvenIa-product-stat">
                                <i class="fas fa-box me-1"></i> Stock: ${product.stock}
                            </span>
                            <span class="AnalInvenIa-product-stat">
                                <i class="fas fa-shopping-cart me-1"></i> Vendus: ${product.sold}
                            </span>
                        </div>
                    </div>
                    <div class="AnalInvenIa-product-status ${statusClass}">
                        <i class="fas ${statusIcon}"></i> ${statusText}
                    </div>
                `;
                
                criticalEl.appendChild(productEl);
            });
        }
    }

    // Mettre à jour l'onglet des produits rentables
    function updateProfitableTab() {
        fillTopProductsContent('profitable');
    }

    // Mettre à jour l'onglet des produits critiques
    function updateCriticalTab() {
        fillTopProductsContent('critical');
    }

    // Remplir l'onglet Produits
    function fillProductsTab() {
        const productsTab = document.getElementById('AnalInvenIa-tab-products');
        if (!productsTab) return;
        
        productsTab.innerHTML = `
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-boxes me-2"></i> Analyse détaillée des produits</span>
                    <div class="AnalInvenIa-products-filter">
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control" placeholder="Rechercher..." id="AnalInvenIa-productTabSearch">
                            <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <i class="fas fa-sort me-1"></i> Trier par
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" data-sort="stock-desc">Stock (décroissant)</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="stock-asc">Stock (croissant)</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="sales-desc">Ventes (décroissant)</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="sales-asc">Ventes (croissant)</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="price-desc">Prix (décroissant)</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="price-asc">Prix (croissant)</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Produit</th>
                                    <th>Catégorie</th>
                                    <th>Stock</th>
                                    <th>Vendus</th>
                                    <th>Prix</th>
                                    <th>Valeur Stock</th>
                                    <th>Tendance</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody id="AnalInvenIa-productsTableBody">
                                <!-- Sera rempli dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-chart-pie me-2"></i> Répartition par catégorie
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-chart-container">
                                <canvas id="AnalInvenIa-categoriesChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-fire me-2"></i> Rotation des stocks
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-chart-container">
                                <canvas id="AnalInvenIa-stockRotationChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        // Remplir le tableau de produits
        const productsTableBody = document.getElementById('AnalInvenIa-productsTableBody');
        if (productsTableBody) {
            productsTableBody.innerHTML = '';
            
            mockProducts.forEach(product => {
                const category = mockCategories.find(cat => cat.id === product.category);
                const stockValue = product.stock * product.price;
                const trendClass = product.trend > 0 ? 'positive' : product.trend < 0 ? 'negative' : 'neutral';
                const trendIcon = product.trend > 0 ? 'fa-arrow-up' : product.trend < 0 ? 'fa-arrow-down' : 'fa-equals';
                
                // Déterminer le statut
                let status, statusClass;
                if (product.stock < 15 && product.sold > 40) {
                    status = 'Rupture probable';
                    statusClass = 'danger';
                } else if (product.stock > 50 && product.sold < 20) {
                    status = 'Surstockage';
                    statusClass = 'warning';
                } else if (product.trend > 10) {
                    status = 'Forte demande';
                    statusClass = 'success';
                } else {
                    status = 'Normal';
                    statusClass = 'primary';
                }
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${product.name}</td>
                    <td>${category ? category.name : 'N/A'}</td>
                    <td>${product.stock}</td>
                    <td>${product.sold}</td>
                    <td>${product.price}€</td>
                    <td>${stockValue}€</td>
                    <td>
                        <span class="AnalInvenIa-trend ${trendClass}">
                            <i class="fas ${trendIcon}"></i> ${Math.abs(product.trend)}%
                        </span>
                    </td>
                    <td><span class="badge bg-${statusClass}">${status}</span></td>
                `;
                
                productsTableBody.appendChild(tr);
            });
        }
        
        // Initialiser les graphiques
        initProductsCharts();
    }

    // Initialiser les graphiques de l'onglet Produits
    function initProductsCharts() {
        // Graphique de répartition par catégorie
        const categoriesCanvas = document.getElementById('AnalInvenIa-categoriesChart');
        if (categoriesCanvas) {
            // Calculer les totaux par catégorie
            const categoryTotals = {};
            mockCategories.forEach(cat => {
                categoryTotals[cat.id] = {
                    name: cat.name,
                    stockValue: 0,
                    salesValue: 0
                };
            });
            
            mockProducts.forEach(product => {
                if (categoryTotals[product.category]) {
                    categoryTotals[product.category].stockValue += product.stock * product.price;
                    categoryTotals[product.category].salesValue += product.sold * product.price;
                }
            });
            
            const labels = Object.values(categoryTotals).map(cat => cat.name);
            const stockData = Object.values(categoryTotals).map(cat => cat.stockValue);
            
            new Chart(categoriesCanvas, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: stockData,
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${context.label}: ${value}€ (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Graphique de rotation des stocks
        const rotationCanvas = document.getElementById('AnalInvenIa-stockRotationChart');
        if (rotationCanvas) {
            // Calculer le taux de rotation pour chaque produit
            const topRotationProducts = [...mockProducts]
                .map(product => ({
                    name: product.name,
                    rotation: product.sold / (product.stock > 0 ? product.stock : 1)
                }))
                .sort((a, b) => b.rotation - a.rotation)
                .slice(0, 7);
            
            const labels = topRotationProducts.map(p => p.name);
            const data = topRotationProducts.map(p => p.rotation);
            
            new Chart(rotationCanvas, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Taux de rotation',
                        data: data,
                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                        borderColor: 'rgb(75, 192, 192)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Taux de rotation: ${context.raw.toFixed(2)}`;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    // Remplir l'onglet Prévisions
    function fillPredictionsTab() {
        const predictionsTab = document.getElementById('AnalInvenIa-tab-predictions');
        if (!predictionsTab) return;
        
        predictionsTab.innerHTML = `
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-crystal-ball me-2"></i> Prévisions IA des ventes
                </div>
                <div class="card-body">
                    <div class="AnalInvenIa-prediction-header mb-4">
                        <h4>Prévisions pour les 3 prochains mois</h4>
                        <p class="text-muted">Basées sur l'historique des ventes et les tendances du marché</p>
                    </div>
                    
                    <div class="AnalInvenIa-chart-container mb-4">
                        <canvas id="AnalInvenIa-salesPredictionChart"></canvas>
                    </div>
                    
                    <div class="AnalInvenIa-prediction-insights">
                        <div class="AnalInvenIa-insight-card">
                            <div class="AnalInvenIa-insight-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="AnalInvenIa-insight-content">
                                <h5>Croissance continue</h5>
                                <p>Nos algorithmes prévoient une croissance globale de 12% pour le prochain trimestre.</p>
                            </div>
                        </div>
                        <div class="AnalInvenIa-insight-card">
                            <div class="AnalInvenIa-insight-icon">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="AnalInvenIa-insight-content">
                                <h5>Pics saisonniers</h5>
                                <p>Préparez-vous à un pic de ventes en juillet avec une augmentation estimée de 22%.</p>
                            </div>
                        </div>
                        <div class="AnalInvenIa-insight-card">
                            <div class="AnalInvenIa-insight-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="AnalInvenIa-insight-content">
                                <h5>Opportunités</h5>
                                <p>L'analyse des tendances suggère un potentiel important pour la catégorie Électronique.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-7">
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="fas fa-exclamation-triangle me-2"></i> Alertes de stock prévisionnelles</span>
                            <div class="AnalInvenIa-prediction-period">
                                Pour les 30 prochains jours
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Produit</th>
                                            <th>Stock actuel</th>
                                            <th>Prévision de vente</th>
                                            <th>Date de rupture estimée</th>
                                            <th>Action recommandée</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Smartphone XL+</td>
                                            <td>32</td>
                                            <td>30 / mois</td>
                                            <td>Dans 32 jours</td>
                                            <td><span class="badge bg-warning">Commander bientôt</span></td>
                                        </tr>
                                        <tr>
                                            <td>Montre connectée Sport</td>
                                            <td>28</td>
                                            <td>25 / mois</td>
                                            <td>Dans 34 jours</td>
                                            <td><span class="badge bg-warning">Commander bientôt</span></td>
                                        </tr>
                                        <tr>
                                            <td>Écouteurs sans fil Pro</td>
                                            <td>45</td>
                                            <td>22 / mois</td>
                                            <td>Dans 61 jours</td>
                                            <td><span class="badge bg-success">Stock suffisant</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-calculator me-2"></i> Estimation financière
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-finance-predictions">
                                <div class="AnalInvenIa-finance-item">
                                    <div class="AnalInvenIa-finance-label">Chiffre d'affaires estimé (prochain mois)</div>
                                    <div class="AnalInvenIa-finance-value">14 800 €</div>
                                    <div class="AnalInvenIa-finance-trend positive">
                                        <i class="fas fa-arrow-up me-1"></i> +12% vs mois précédent
                                    </div>
                                </div>
                                <div class="AnalInvenIa-finance-item">
                                    <div class="AnalInvenIa-finance-label">Produit le plus rentable (prévision)</div>
                                    <div class="AnalInvenIa-finance-product">Smartphone XL+</div>
                                    <div class="AnalInvenIa-finance-value">4 250 €</div>
                                </div>
                                <div class="AnalInvenIa-finance-item">
                                    <div class="AnalInvenIa-finance-label">Catégorie en plus forte croissance</div>
                                    <div class="AnalInvenIa-finance-product">Électronique</div>
                                    <div class="AnalInvenIa-finance-trend positive">
                                        <i class="fas fa-arrow-up me-1"></i> +18%
                                    </div>
                                </div>
                            </div>
                            <div class="AnalInvenIa-prediction-chart-container mt-4">
                                <canvas id="AnalInvenIa-financePredictionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        initPredictionCharts();
    }

    // Initialiser les graphiques de prévision
    function initPredictionCharts() {
        // Graphique de prévision des ventes
        const salesPredictionCanvas = document.getElementById('AnalInvenIa-salesPredictionChart');
        if (salesPredictionCanvas) {
            const months = ['Mai', 'Juin', 'Juillet', 'Août'];
            const historicalData = [11200, 12450, null, null];
            const predictedData = [null, null, 14000, 15600];
            
            new Chart(salesPredictionCanvas, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Données historiques',
                        data: historicalData,
                        borderColor: 'rgba(54, 162, 235, 1)',
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderWidth: 2,
                        pointRadius: 4,
                        fill: true
                    }, {
                        label: 'Prévisions',
                        data: predictedData,
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return value + '€';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + '€';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Graphique de prévision financière
        const financePredictionCanvas = document.getElementById('AnalInvenIa-financePredictionChart');
        if (financePredictionCanvas) {
            const categories = ['Électronique', 'Mobilier', 'Vêtements', 'Alimentaire'];
            const currentData = [8200, 2300, 1500, 950];
            const forecastData = [9676, 2415, 1470, 1045];
            
            new Chart(financePredictionCanvas, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [{
                        label: 'Ce mois-ci',
                        data: currentData,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgb(54, 162, 235)',
                        borderWidth: 1
                    }, {
                        label: 'Mois prochain (prévision)',
                        data: forecastData,
                        backgroundColor: 'rgba(255, 99, 132, 0.7)',
                        borderColor: 'rgb(255, 99, 132)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return value + '€';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + '€';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    // Remplir l'onglet Recommandations
    function fillRecommendationsTab() {
        const recommendationsTab = document.getElementById('AnalInvenIa-tab-recommendations');
        if (!recommendationsTab) return;
        
        recommendationsTab.innerHTML = `
            <div class="AnalInvenIa-recommendations-header mb-4">
                <div class="AnalInvenIa-recommendations-title">
                    <i class="fas fa-lightbulb me-2"></i>
                    <h4>Recommandations IA</h4>
                </div>
                <div class="AnalInvenIa-recommendations-summary">
                    Notre intelligence artificielle a analysé vos données et vous propose des actions concrètes pour optimiser votre gestion.
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-8">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-star me-2"></i> Recommandations prioritaires
                        </div>
                        <div class="card-body p-0">
                            <div class="AnalInvenIa-recommendation-list" id="AnalInvenIa-priorityRecommendations">
                                <!-- Sera rempli dynamiquement -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="fas fa-chart-bar me-2"></i> Impact estimé
                        </div>
                        <div class="card-body">
                            <div class="AnalInvenIa-impact">
                                <div class="AnalInvenIa-impact-item">
                                    <div class="AnalInvenIa-impact-icon positive">
                                        <i class="fas fa-hand-holding-usd"></i>
                                    </div>
                                    <div class="AnalInvenIa-impact-content">
                                        <div class="AnalInvenIa-impact-value">+2 400 €</div>
                                        <div class="AnalInvenIa-impact-label">Revenus additionnels</div>
                                    </div>
                                </div>
                                <div class="AnalInvenIa-impact-item">
                                    <div class="AnalInvenIa-impact-icon positive">
                                        <i class="fas fa-percent"></i>
                                    </div>
                                    <div class="AnalInvenIa-impact-content">
                                        <div class="AnalInvenIa-impact-value">+14%</div>
                                        <div class="AnalInvenIa-impact-label">Marge optimisée</div>
                                    </div>
                                </div>
                                <div class="AnalInvenIa-impact-item">
                                    <div class="AnalInvenIa-impact-icon negative">
                                        <i class="fas fa-coins"></i>
                                    </div>
                                    <div class="AnalInvenIa-impact-content">
                                        <div class="AnalInvenIa-impact-value">-3 800 €</div>
                                        <div class="AnalInvenIa-impact-label">Réduction des surstockages</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-list-check me-2"></i> Toutes les recommandations
                </div>
                <div class="card-body p-0">
                    <div class="AnalInvenIa-tabs AnalInvenIa-tabs-small">
                        <div class="AnalInvenIa-tab active" data-rectab="all">
                            <i class="fas fa-border-all"></i> Toutes
                        </div>
                        <div class="AnalInvenIa-tab" data-rectab="stock">
                            <i class="fas fa-box"></i> Stock
                        </div>
                        <div class="AnalInvenIa-tab" data-rectab="pricing">
                            <i class="fas fa-tag"></i> Prix
                        </div>
                        <div class="AnalInvenIa-tab" data-rectab="marketing">
                            <i class="fas fa-bullhorn"></i> Marketing
                        </div>
                    </div>
                    <div class="AnalInvenIa-recommendation-grid" id="AnalInvenIa-allRecommendations">
                        <!-- Sera rempli dynamiquement -->
                    </div>
                </div>
            </div>
        `;
        
        // Remplir les recommandations prioritaires
        const priorityRecommendationsEl = document.getElementById('AnalInvenIa-priorityRecommendations');
        if (priorityRecommendationsEl) {
            const topRecommendations = mockRecommendations.slice(0, 3);
            
            priorityRecommendationsEl.innerHTML = '';
            topRecommendations.forEach(rec => {
                const recItem = document.createElement('div');
                recItem.className = 'AnalInvenIa-recommendation-item';
                recItem.innerHTML = `
                    <div class="AnalInvenIa-recommendation-icon">
                        <i class="${rec.icon}"></i>
                    </div>
                    <div class="AnalInvenIa-recommendation-content">
                        <div class="AnalInvenIa-recommendation-title">${rec.title}</div>
                        <div class="AnalInvenIa-recommendation-description">
                            ${rec.description}
                        </div>
                    </div>
                    <div class="AnalInvenIa-recommendation-action">
                        <button class="btn btn-sm btn-outline-primary">Appliquer</button>
                    </div>
                `;
                
                priorityRecommendationsEl.appendChild(recItem);
            });
        }
        
        // Remplir toutes les recommandations
        const allRecommendationsEl = document.getElementById('AnalInvenIa-allRecommendations');
        if (allRecommendationsEl) {
            allRecommendationsEl.innerHTML = '';
            
            mockRecommendations.forEach(rec => {
                const recItem = document.createElement('div');
                recItem.className = 'AnalInvenIa-recommendation-card';
                recItem.setAttribute('data-rectype', getRecommendationType(rec.type));
                recItem.innerHTML = `
                    <div class="AnalInvenIa-recommendation-card-header">
                        <div class="AnalInvenIa-recommendation-card-icon">
                            <i class="${rec.icon}"></i>
                        </div>
                        <div class="AnalInvenIa-recommendation-card-badge ${getRecommendationClass(rec.type)}">
                            ${getRecommendationLabel(rec.type)}
                        </div>
                    </div>
                    <div class="AnalInvenIa-recommendation-card-title">${rec.title}</div>
                    <div class="AnalInvenIa-recommendation-card-description">
                        ${rec.description}
                    </div>
                    <div class="AnalInvenIa-recommendation-card-footer">
                        <button class="btn btn-sm btn-outline-secondary">Ignorer</button>
                        <button class="btn btn-sm btn-primary">Appliquer</button>
                    </div>
                `;
                
                allRecommendationsEl.appendChild(recItem);
            });
            
            // Ajouter la gestion des onglets de recommandations
            const recTabs = document.querySelectorAll('.AnalInvenIa-tab[data-rectab]');
            recTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-rectab');
                    
                    // Désactiver tous les onglets
                    recTabs.forEach(t => t.classList.remove('active'));
                    
                    // Activer l'onglet sélectionné
                    this.classList.add('active');
                    
                    // Filtrer les recommandations
                    const recCards = document.querySelectorAll('.AnalInvenIa-recommendation-card');
                    recCards.forEach(card => {
                        if (tabId === 'all' || card.getAttribute('data-rectype') === tabId) {
                            card.style.display = 'flex';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            });
        }
    }

    // Déterminer le type de recommandation pour le filtrage
    function getRecommendationType(type) {
        switch (type) {
            case 'increase_stock':
            case 'reduce_stock':
            case 'restock':
                return 'stock';
            case 'price_up':
            case 'price_down':
                return 'pricing';
            case 'promotion':
            case 'bundle':
                return 'marketing';
            default:
                return 'other';
        }
    }

    // Obtenir la classe CSS pour le badge de recommandation
    function getRecommendationClass(type) {
        switch (type) {
            case 'increase_stock':
            case 'restock':
            case 'price_up':
                return 'success';
            case 'reduce_stock':
            case 'price_down':
                return 'warning';
            case 'promotion':
            case 'bundle':
                return 'info';
            default:
                return 'primary';
        }
    }

    // Obtenir le label pour le badge de recommandation
    function getRecommendationLabel(type) {
        switch (type) {
            case 'increase_stock':
                return 'Augmenter Stock';
            case 'reduce_stock':
                return 'Réduire Stock';
            case 'restock':
                return 'Réapprovisionner';
            case 'price_up':
                return 'Augmenter Prix';
            case 'price_down':
                return 'Réduire Prix';
            case 'promotion':
                return 'Promotion';
            case 'bundle':
                return 'Bundle';
            default:
                return 'Action';
        }
    }

    // Réinitialiser les paramètres d'analyse
    function resetAnalysisParams() {
        // Réinitialiser les filtres
        filterTabs[0].click();
        customFilterTabs[0].click();
        
        // Réinitialiser la portée
        scopeOptions[0].click();
        
        // Réinitialiser les selects
        selects.forEach(select => {
            const defaultOption = select.querySelector('.AnalInvenIa-select-option');
            if (defaultOption) {
                select.querySelector('.AnalInvenIa-select-value').textContent = defaultOption.textContent.trim();
            }
        });
        
        // Réinitialiser les variables d'état
        currentFilter = 1;
        currentCustomFilter = 'range';
        currentScope = 'global';
        selectedCategory = null;
        selectedProduct = null;
        
        // Masquer les sélecteurs spécifiques
        categorySelector.style.display = 'none';
        productSelector.style.display = 'none';
        selectedProductDisplay.style.display = 'none';
    }

    // Formater une date
    function formatDate(date) {
        return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
    }

    // Formater une heure
    function formatTime(date) {
        return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
    }

    // Obtenir le nom du mois
    function getMonthName(monthIndex) {
        const months = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
        return months[monthIndex];
    }
    
    // Charger les dépendances externes (Chart.js)
    function loadChartJS() {
        if (window.Chart) return Promise.resolve();
        
        return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
            script.onload = resolve;
            script.onerror = reject;
            document.head.appendChild(script);
        });
    }
    
    // Charger Chart.js
    loadChartJS().then(() => {
        console.log('Chart.js chargé avec succès');
    }).catch(err => {
        console.error('Erreur lors du chargement de Chart.js:', err);
    });
});

</script>
